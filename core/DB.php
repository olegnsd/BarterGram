<?phpnamespace dvijok\core;class DB {	public $link;	public $stmt;	public $result;	public function __construct($host, $user, $pass, $db) {		$link = mysqli_connect($host, $user, $pass, $db);				if (!$link) {							echo mysqli_connect_errno() . "<br />";			echo mysqli_connect_error();			exit;		}				$link->set_charset("utf8");		$this->link = $link;	}	public function insertId() {		return $this->link->insert_id;	}	public function query($query,$params = array()) {		if ($this->stmt = $this->link->prepare($query)) {			 $paramsBind = array('');						 foreach($params as $p)			 {				if(gettype($p) == 'string')				{					//$this->stmt->bind_param("s", $p);										$paramsBind[0] .= 's';				}				else				if(gettype($p) == 'integer')				{					//$this->$stmt->bind_param("i", $p);					$paramsBind[0] .= 'i';				}				else				if(gettype($p) == 'double')				{					//$this->stmt->bind_param("d", $p);					$paramsBind[0] .= 'd';				}				else				{					//$this->stmt->bind_param("s", $p);					$paramsBind[0] .= 's';				}				$paramsBind[] = $p;			 }			 if($params)			 {				call_user_func_array(array($this->stmt, 'bind_param'), $this->refValues($paramsBind));			 }			 $this->stmt->execute();			 $this->result = $this->stmt->get_result();			 		}		else		{			echo $this->link->error;		}		return $this;	}	public function fetch() {		if($this->result)		{			return $this->result->fetch_assoc();		}		return false;	}	public function fetchAll() {		$data = array();		while ($res = $this->result->fetch_assoc()) {			$data[] = $res;		}		return $data;	}		function refValues($arr){		if (strnatcmp(phpversion(),'5.3') >= 0)		{			$refs = array();			foreach($arr as $key => $value)				$refs[$key] = &$arr[$key];			return $refs;		}		return $arr;	}}